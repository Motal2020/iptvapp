
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Lecteur IPTV Universel</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #111; color: #fff; }
    #configForm, #playerContainer, #channelList { padding: 20px; }
    input, select, button { padding: 8px; margin: 5px; width: 100%; max-width: 300px; }
    #player { width: 100%; max-width: 800px; height: 450px; background: #000; margin-top: 20px; }
    #channelList { max-height: 300px; overflow-y: auto; }
    .channel { cursor: pointer; padding: 5px; border-bottom: 1px solid #444; }
    .channel:hover { background: #333; }
  </style>
</head>
<body>

<div id="configForm">
  <h2>Configuration IPTV</h2>
  <label>Type de connexion :</label>
  <select id="connType">
    <option value="xtream">Xtream Codes</option>
    <option value="m3u">Lien M3U/M3U8</option>
  </select><br>
  <div id="xtreamFields">
    <input type="text" id="serverUrl" placeholder="URL du serveur (ex: http://iptv.example.com:8080)">
    <input type="text" id="username" placeholder="Nom d'utilisateur">
    <input type="password" id="password" placeholder="Mot de passe">
  </div>
  <div id="m3uFields" style="display:none;">
    <input type="text" id="m3uUrl" placeholder="Lien M3U/M3U8">
  </div>
  <button onclick="saveConfig()">Se connecter</button>
</div>

<div id="playerContainer" style="display:none;">
  <h2>Lecteur IPTV</h2>
  <div id="channelList"></div>
  <video id="player" controls autoplay></video>
  <button onclick="logout()">Déconnexion</button>
</div>

<script>
  const connTypeEl = document.getElementById('connType');
  const xtreamFields = document.getElementById('xtreamFields');
  const m3uFields = document.getElementById('m3uFields');

  connTypeEl.addEventListener('change', function () {
    if (this.value === 'xtream') {
      xtreamFields.style.display = 'block';
      m3uFields.style.display = 'none';
    } else {
      xtreamFields.style.display = 'none';
      m3uFields.style.display = 'block';
    }
  });

  function saveConfig() {
    const type = connTypeEl.value;
    let config = { type };
    if (type === 'xtream') {
      config.server = document.getElementById('serverUrl').value;
      config.username = document.getElementById('username').value;
      config.password = document.getElementById('password').value;
      // Demo: simulate stream
      config.demo = 'http://iptv.example.com:8080/movie/demo1.m3u8';
    } else {
      config.m3u = document.getElementById('m3uUrl').value;
    }
    localStorage.setItem('iptv_config', JSON.stringify(config));
    loadPlayer();
  }

  function logout() {
    localStorage.removeItem('iptv_config');
    location.reload();
  }

  function loadPlayer() {
    document.getElementById('configForm').style.display = 'none';
    document.getElementById('playerContainer').style.display = 'block';

    const config = JSON.parse(localStorage.getItem('iptv_config'));
    const player = document.getElementById('player');
    const channelList = document.getElementById('channelList');

    if (config.type === 'xtream') {
      channelList.innerHTML = '<div class="channel" onclick="playChannel(\'' + config.demo + '\')">Film Démo</div>';
    } else {
      channelList.innerHTML = '<div class="channel" onclick="playChannel(\'' + config.m3u + '\')">Chaîne M3U</div>';
    }
  }

  function playChannel(url) {
    const player = document.getElementById('player');
    player.src = url;
    player.play();
  }

  window.onload = function () {
    if (localStorage.getItem('iptv_config')) {
      loadPlayer();
    }
  }
</script>

</body>
</html>
